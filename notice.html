<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê³µì§€ì‚¬í•­ - í•œêµ­ì‹¤ë²„ê±´ê°•ì§€ë„ìí˜‘íšŒ í¬í•­ì§€ë¶€</title>
  <link rel="stylesheet" href="css/base.css" />
  <style>
    .notice-form {
      margin-bottom: 20px;
      padding: 16px;
      background: #fff;
      border-radius: 8px;
      border: 1px solid #e0e6f0;
    }
    .notice-form input,
    .notice-form textarea {
      width: 100%;
      margin-bottom: 8px;
      padding: 6px 8px;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 14px;
      box-sizing: border-box;
    }
    .notice-form button {
      padding: 8px 14px;
      border-radius: 4px;
      border: none;
      background: var(--main-color);
      color: #fff;
      font-size: 14px;
      cursor: pointer;
    }
    .notice-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .notice-item {
      background: #fff;
      border-radius: 8px;
      padding: 12px;
      border: 1px solid #e0e6f0;
    }
    .notice-item h3 {
      margin: 0 0 4px;
      font-size: 15px;
    }
    .notice-date {
      font-size: 12px;
      color: #777;
      margin-bottom: 6px;
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="container header-inner">
      <div class="logo">
        <img src="images/logo.png" alt="ë¡œê³ " />
        <div class="logo-text">
          <span class="logo-main">í•œêµ­ì‹¤ë²„ê±´ê°•ì§€ë„ìí˜‘íšŒ</span>
          <span class="logo-sub">í¬í•­ì§€ë¶€</span>
        </div>
      </div>
      <nav class="nav">
        <a href="index.html">í™ˆ</a>
        <a href="about.html">ì§€ë¶€ì†Œê°œ</a>
        <a href="course.html">êµìœ¡ê³¼ì •</a>
        <a href="schedule.html">êµìœ¡ì¼ì •</a>
        <a href="gallery.html">ê°¤ëŸ¬ë¦¬</a>
        <a href="contact.html">ì˜¤ì‹œëŠ” ê¸¸/ë¬¸ì˜</a>
        <a href="notice.html">ê³µì§€ì‚¬í•­</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="section">
      <div class="container">
        <h2 class="section-title">ê³µì§€ì‚¬í•­</h2>

        <!-- ê´€ë¦¬ììš© ê°„ë‹¨ ì‘ì„± í¼ (ì§€ê¸ˆì€ ë¹„ë°€ë²ˆí˜¸ ì—†ì´ ì‚¬ìš©) -->
        <div class="notice-form">
          <input id="title" type="text" placeholder="ì œëª©" />
          <textarea id="content" rows="4" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
          <button id="saveBtn">ê²Œì‹œê¸€ ì €ì¥</button>
          <p id="status" style="font-size:12px;color:#777;margin-top:6px;"></p>
        </div>

        <div class="notice-list" id="noticeList"></div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <p>í•œêµ­ì‹¤ë²„ê±´ê°•ì§€ë„ìí˜‘íšŒ í¬í•­ì§€ë¶€</p>
      <p class="footer-info">
        í¬í•­ì‹œ ë‚¨êµ¬ ì˜¤ì²œì ì •ëª½ì£¼ë¡œ 615, 3ì¸µ Â· ì „í™” 010-2264-1088
      </p>
      <p class="footer-copy">
        Â© 2026 í•œêµ­ì‹¤ë²„ê±´ê°•ì§€ë„ìí˜‘íšŒ í¬í•­ì§€ë¶€. All rights reserved.
      </p>
    </div>
  </footer>

  <script>
    // ğŸ”¥ ì—¬ê¸°ì— Renderì—ì„œ ë°›ì€ API ì£¼ì†Œ ì…ë ¥
    const API_BASE = "https://pohang-branch-server.onrender.com";

    const titleInput = document.getElementById("title");
    const contentInput = document.getElementById("content");
    const saveBtn = document.getElementById("saveBtn");
    const statusEl = document.getElementById("status");
    const noticeList = document.getElementById("noticeList");

    async function loadPosts() {
      noticeList.innerHTML = "ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...";
      try {
        const res = await fetch(`${API_BASE}/posts`);
        const posts = await res.json();
        if (!Array.isArray(posts)) {
          noticeList.textContent = "ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
          return;
        }
        if (posts.length === 0) {
          noticeList.textContent = "ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.";
          return;
        }
        noticeList.innerHTML = "";
        posts.forEach((post) => {
          const div = document.createElement("div");
          div.className = "notice-item";
          const date = new Date(post.createdAt);
          div.innerHTML = `
            <h3>${post.title}</h3>
            <div class="notice-date">${date.toLocaleString("ko-KR")}</div>
            <div>${post.content.replace(/\n/g, "<br>")}</div>
          `;
          noticeList.appendChild(div);
        });
      } catch (err) {
        console.error(err);
        noticeList.textContent = "ê³µì§€ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
      }
    }

    saveBtn.addEventListener("click", async () => {
      const title = titleInput.value.trim();
      const content = contentInput.value.trim();
      if (!title || !content) {
        statusEl.textContent = "ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
        return;
      }
      statusEl.textContent = "ì €ì¥ ì¤‘...";
      try {
        const res = await fetch(`${API_BASE}/posts`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ title, content }),
        });
        if (!res.ok) throw new Error("ì €ì¥ ì‹¤íŒ¨");
        titleInput.value = "";
        contentInput.value = "";
        statusEl.textContent = "ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.";
        loadPosts();
      } catch (err) {
        console.error(err);
        statusEl.textContent = "ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
      }
    });

    loadPosts();
  </script>
</body>
</html>
